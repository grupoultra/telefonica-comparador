"use strict";var app=angular.module("comparadorApp",["ngLodash"]);app.factory("CellphonesService",["$q","$http",function(e,a){var o={};return o.cellphones=[{id_telefono:686,imagen_peq:"Alcatel_Idol_2_mini_S_Small.png",imagen_gra:"",nombre:"Idol 2 mini S",precio:35659820,precio_prom:"",club_movistar:62e5,link:"",inventario:!0,peso:116,tamano:"129x63x9",destacado:!0,gama:8,marca:"Alcatel",otras:"Teléfonos inteligentes",tecnologia:"LTE",frecuencias:[850,900,1800,1900,2100,1700],redes:["GPRS","EDGE","HSPA","LTE"],antena:"Integrada",diseno:"Touch",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"",fecha_hasta:""},{id_telefono:666,imagen_peq:"Blu Aria II Small.png",imagen_gra:"",nombre:"Aria II",precio:2909821,precio_prom:"",club_movistar:71e4,link:"",inventario:!0,peso:65,tamano:"108x45x14",destacado:!0,gama:1,marca:"Blu",otras:"Cámara VGA",tecnologia:"GSM",frecuencias:[850,900,1800,1900],redes:["GPRS"],antena:"Integrada",diseno:"Candy Bar",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"2017-05-18T16:36:38.822Z",fecha_hasta:"2017-05-18T16:36:38.822Z"},{id_telefono:699,imagen_peq:"Blu_Dash_JR_3G_small.png",imagen_gra:"",nombre:"Blu Dash Jr.",precio:16989480,precio_prom:"",club_movistar:0,link:"",inventario:!0,peso:106,tamano:"117x63x11",destacado:!0,gama:1,marca:"Blu",otras:"Cámara VGA",tecnologia:"3G",frecuencias:[850,1900,2100],redes:["HSPA"],antena:"Integrada",diseno:"Touch",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"2017-05-18T16:36:38.822Z",fecha_hasta:"2017-05-18T16:36:38.822Z"},{id_telefono:689,imagen_peq:"BLU_JENNY_2_Small_v1.png",imagen_gra:"",nombre:"Jenny II",precio:5061610,precio_prom:"",club_movistar:1e6,link:"",inventario:!0,peso:100,tamano:"112x47x8",destacado:!0,gama:1,marca:"Blu",otras:"Cámara VGA",tecnologia:"GSM",frecuencias:[850,900,1800,1900],redes:["GPRS"],antena:"Integrada",diseno:"Candy Bar",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"2017-05-18T16:36:38.822Z",fecha_hasta:"2017-05-18T16:36:38.822Z"},{id_telefono:690,imagen_peq:"BLU_TANK2_Small_v1.png",imagen_gra:"",nombre:"Tank II",precio:5454464,precio_prom:"",club_movistar:11e5,link:"",inventario:!0,peso:100,tamano:"112x47x13",destacado:!0,gama:1,marca:"Blu",otras:"Cámara VGA",tecnologia:"GSM",frecuencias:[850,900,1800,1900],redes:["GPRS"],antena:"Integrada",diseno:"Candy Bar",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"2017-05-18T16:36:38.822Z",fecha_hasta:"2017-05-18T16:36:38.822Z"},{id_telefono:678,imagen_peq:"Blu_Zoey_Small.png",imagen_gra:"",nombre:"Zoey",precio:215089,precio_prom:"",club_movistar:66e4,link:"",inventario:!0,peso:65,tamano:"110x45x13",destacado:!0,gama:4,marca:"Blu",otras:"Pantalla a color",tecnologia:"GSM",frecuencias:[850,900,1800,1900],redes:["GPRS"],antena:"Interna",diseno:"Candy Bar",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"2017-05-18T16:36:38.822Z",fecha_hasta:"2017-05-18T16:36:38.822Z"},{id_telefono:673,imagen_peq:"blu_zoey_2_small(1).png",imagen_gra:"",nombre:"Zoey 2",precio:8,precio_prom:"",club_movistar:8e5,link:"",inventario:!0,peso:92,tamano:"109x85x13",destacado:!0,gama:4,marca:"Blu",otras:"Pantalla a color",tecnologia:"GSM",frecuencias:[850,1800,1900],redes:["GPRS"],antena:"Integrada",diseno:"Candy Bar",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"2017-05-18T16:36:38.822Z",fecha_hasta:"2017-05-18T16:36:38.822Z"}],o.selectedCellphones=[],o.getAll=function(){return o.cellphone=[{id_telefono:686,imagen_peq:"Alcatel_Idol_2_mini_S_Small.png",imagen_gra:"",nombre:"Idol 2 mini S",precio:35659820,precio_prom:"",club_movistar:62e5,link:"",inventario:!0,peso:116,tamano:"129x63x9",destacado:!0,gama:8,marca:"Alcatel",otras:"Teléfonos inteligentes",tecnologia:"LTE",frecuencias:[850,900,1800,1900,2100,1700],redes:["GPRS","EDGE","HSPA","LTE"],antena:"Integrada",diseno:"Touch",precio_prepago:"",precio_pospago:"",material_sap:"",fecha_desde:"",fecha_hasta:""}],e.when()},o.setSelected=function(e){o.selectedCellphones=_.filter(o.cellphones,function(a){return _.includes(e,a.id_telefono)})},o}]),app.controller("PhoneListCtrl",["$scope","lodash","CellphonesService","$location",function(e,a,o,n){e.selectedCellphones=[],e.showComparador=!1,e.$watch("hastaPrecio",function(){},!0),e.iva=.14,o.getAll().then(function(n){var t=o.cellphones;e.cellphones=t,e.cellphonesFiltered=t,e.minPrecio=parseInt((a.minBy(t,"precio").precio/1e3).toFixed(0)),e.maxPrecio=parseInt((a.maxBy(t,"precio").precio/1e3).toFixed(0)),e.desdePrecio=e.minPrecio,e.hastaPrecio=e.maxPrecio,e.minPuntos=a.minBy(t,"club_movistar").club_movistar,e.maxPuntos=a.maxBy(t,"club_movistar").club_movistar,e.desdePuntos=e.minPuntos,e.hastaPuntos=e.maxPuntos,e.destacadoChoices=0,e.selectedMarcas=[],e.marcas=a(t).sortBy("marca").groupBy("marca").keys().value(),e.selectedTecnologias=[],e.tecnologias=a(t).sortBy("tecnologia").groupBy("tecnologia").keys().value(),e.selectedAntenas=[],e.antenas=a(t).sortBy("antena").groupBy("antena").keys().value(),e.selectedFrecuencias=[],e.frecuencias=a(t).map(function(e){return e.frecuencias}).flattenDeep().uniq().value(),e.selectedRedes=[],e.redes=a(t).map(function(e){return e.redes}).flattenDeep().uniq().value(),e.selectedDisenos=[],e.disenos=a(t).sortBy("diseno").groupBy("diseno").keys().value(),e.selectedOtras=[],e.otras=a(t).sortBy("otras").groupBy("otras").keys().value()}).catch(function(e){}),e.getPrecio=function(e){return(e.precio/1e3).toFixed(2)},e.getIVA=function(a){return(e.getPrecio(a)*e.iva).toFixed(2)},e.getTotalPrice=function(a){return(e.getPrecio(a)*(e.iva+1)).toFixed(2)},e.getCellphoneImage=function(e){return"http://movistar.com.ve/comparador/uploads/"+e.imagen_peq},e.updateModel=function(a,o){e[a]=o,e.filterCellphones()},e.changeDestacados=function(a){e.destacadoChoices=a,e.filterCellphones()},e.filterCellphones=function(){var o=e.desdePrecio?e.desdePrecio:e.minPrecio,n=e.hastaPrecio?e.hastaPrecio:e.maxPrecio,t=e.desdePuntos?e.desdePuntos:e.minPuntos,r=e.hastaPuntos?e.hastaPuntos:e.maxPuntos;e.cellphonesFiltered=a.filter(e.cellphones,function(s){var c=parseInt(e.getPrecio(s))>=o,i=parseInt(e.getPrecio(s))<=n,l=parseInt(s.club_movistar)>=t,p=parseInt(s.club_movistar)<=r,d=!0,m=!0,u=!0,_=!0,g=!0,h=!0,f=!0,v=!0;return e.destacadoChoices>0&&(d=s.destacado),e.selectedMarcas.length>0&&(m=a.includes(e.selectedMarcas,s.marca)),e.selectedTecnologias.length>0&&(u=a.includes(e.selectedTecnologias,s.tecnologia)),e.selectedAntenas.length>0&&(_=a.includes(e.selectedAntenas,s.antena)),e.selectedFrecuencias.length>0&&(g=a.intersection(e.selectedFrecuencias,s.frecuencias).length>0),e.selectedRedes.length>0&&(h=a.intersection(e.selectedRedes,s.redes).length>0),e.selectedDisenos.length>0&&(f=a.includes(e.selectedDisenos,s.diseno)),e.selectedOtras.length>0&&(v=a.includes(e.selectedOtras,s.otras)),c&&i&&l&&p&&d&&m&&u&&_&&g&&h&&f&&v})},e.getSelectedIds=function(){var o="";return a.each(e.selectedCellphones,function(e){o+=e}),e.selectedCellphones.join(",")},e.toggleSelection=function(o,n){var t=e["selected"+a.upperFirst(o)+"s"],r=t.indexOf(n);r>-1?t.splice(r,1):"cellphone"===o&&4===e.selectedCellphones.length||t.push(n),"cellphone"!==o&&e.filterCellphones()},e.isSelected=function(o,n){return e["selected"+a.upperFirst(o)+"s"].indexOf(n)>-1},e.goAndCompare=function(){e.showComparador=!0,o.setSelected(e.selectedCellphones),e.cellphonesToCompare=o.selectedCellphones},e.closeComparador=function(){e.showComparador=!1}}]);